<script src="<%= url_for(theme.js.lazysizes) %>" async></script>
<script type="text/javascript">
  // http://css-tricks.com/favicons-next-to-external-links/
  for (const link of document.querySelectorAll('.content p a')){
    const hostname = link.hostname;
    if (hostname) {
      const children = link.children || [];
      const firstChild = children && children[0];
      if (firstChild && firstChild.tagName === 'IMG') {
        // For old amazon image link
        if (link.hostname === 'www.amazon.co.jp') {
          link.style.float = 'left';
          link.style.marginRight = '1em';
          link.style.paddingLeft = '0';
        }
        continue;
      }

      link.classList.add('link-icon');
      link.style.backgroundImage = `url(https://www.google.com/s2/favicons?domain=${hostname})`;
    }
  }
</script>
