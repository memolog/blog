---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { getCollection } from "astro:content";
import FormattedDate from "../components/FormattedDate.astro";
import FeaturedImage from "../components/FeaturedImage.astro";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<!doctype html>
<html lang="ja">
  <head>
    <BaseHead />
    <script
      type="application/ld+json"
      set:html={JSON.stringify({
        "@context": "http://schema.org",
        "@type": "ItemList",
        itemListElement: posts.map((post, index) => {
          return {
            "@type": "ListItem",
            position: index + 1,
            url: post.filePath,
          };
        }),
      })}
    />
  </head>
  <body>
    <Header />
    <div class="container">
      <main class="main">
        {
          posts.map((post) => (
            <article class="article-summary">
              <header class="header">
                <div>
                  <FormattedDate date={post.data.date} />
                </div>
                <h2 class="header__title article__title">
                  <a href={`/${post.id}/`}>{post.data.title}</a>
                </h2>
                {post.data.featured && (
                  <FeaturedImage featured={post.data.featured} />
                )}
              </header>
              <div class="content">{post.data.excerpt}</div>
              <div>
                <a href={`/${post.id}/`}>üìñ Á∂ö„Åç„ÇíË™≠„ÇÄ</a>
              </div>
            </article>
          ))
        }
      </main>
      <Footer />
    </div>
  </body>
</html>
