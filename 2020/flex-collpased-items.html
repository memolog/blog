<!DOCTYPE html><html lang="ja"> <head><title>Collapsed Items | メモログ</title><meta name="description" content="塵が積もって山とならないメモのログ" id="meta-description"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/assets/icons/icon-32.ico"><style>
  :root {
    --container-width: 985px;
    --link-color: #694b16;
    --background-color: #e3ded5;
    --lighter-color: #fdf8ee;
    --darker-color: #cac5bc;
    --more-dark-color: #b1aca4;
    --border-color: #cac5bc;
    --profile-text-color: #55514a;
    --article-background-color: white;
    --profile-background-color: var(--border-color);
    --border-radius: 10px;
    --pagination-item-width: 61px;
    --featured-caption-color: #534f48;
  }

  * {
    box-sizing: border-box;
  }

  body {
    background-color: var(--background-color);
    color: black;
    font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue",
      "Hiragino Kaku Gothic Pro", YuGothic, "Yu Gothic", Meiryo, sans-serif;
    margin: 0;
    padding: 0;
  }

  a {
    color: var(--link-color);
  }

  .header {
    margin: 0 auto;
    font-family: Garamond, "Times New Roman", serif;
  }

  .header:has(.featured__image) {
    margin-bottom: 2em;
  }

  .header_component_global {
    width: 100%;
  }

  .header-inner {
    text-align: center;
    margin: 5px auto;
    max-width: var(--container-width);
    display: grid;
    grid-template-columns: 36px 96px auto;
    align-items: center;
  }

  .header__icon {
    justify-self: end;
  }

  .header__title {
    margin: 0.2em 0 0.2em;
    font-size: 1.8em;
    font-weight: normal;
    vertical-align: bottom;
  }

  .header__title a,
  .header__title > span {
    color: black;
    text-decoration: none;
  }

  .header_component_global .header__title {
    font-family: sans-serif;
    font-size: 14px;
    line-height: 16px;
    font-weight: bold;
    justify-self: start;
  }

  .header_component_global .header__title a {
    text-decoration: none;
    color: black;
    padding: 7px 5px;
    background-color: transparent;
  }

  .header_component_global .navigation-global {
    justify-self: end;
    padding-right: 10px;
    font-family: sans-serif;
  }

  .header__description {
    margin-top: 0;
    margin-bottom: 1em;
  }

  .header_component_global .header__description {
    color: #666;
    margin: 0 auto;
    padding: 0 5px;
  }

  .header__epigraph {
    font-style: italic;
    color: #666;
    margin: 0 auto;
    padding: 5px;
  }

  .container {
    width: var(--container-width);
    max-width: 100%;
    margin: 0 auto 4em;
    padding: 0;
    border-radius: var(--border-radius);
  }

  article {
    background-color: var(--article-background-color);
    padding: 2em;
    border-radius: var(--border-radius);
  }

  .content {
    font-size: 1.125em;
    line-height: 2em;
    background: var(--article-background-color);
    color: #222;
    -webkit-font-smoothing: antialiased;
  }

  .read-more {
    margin-top: 1em;
  }

  .content h2,
  .content h3 {
    font-size: 1.4em;
    margin: 2em 0 1em 0;
    border-bottom: 1px solid #ddd;
  }

  .article-summary {
    margin-bottom: 3.5em;
  }

  .header time {
    display: inline-block;
    font-size: 0.8125em;
    color: #666;
    font-family: sans-serif;
  }

  .calendar-icon,
  .author-icon {
    margin-right: 0.5em;
  }

  .content blockquote {
    border: 5px solid var(--border-color);
    background: var(--lighter-color);
    margin: 1.5em 0;
    padding: 0 1em;
    border-radius: var(--border-radius);
  }

  .content p > code,
  .content li > code {
    background-color: #f5f2f0;
    display: inline-block;
    padding: 0 6px;
    border-radius: var(--border-radius);
    color: #444;
  }

  .content table {
    background: #e0e0e0;
  }

  .content th {
    background: #f0f0f0;
  }

  .content tr {
    background: #fff;
  }

  .content tr:nth-child(even) {
    background: #f0f0f0;
  }

  .content td {
    padding: 5px 1em;
    text-align: center;
  }

  .header__feature {
    margin: 0.5em 0 -0.5em;
    position: relative;
  }

  .header__feature img {
    overflow: hidden;
  }

  .featured__image {
    background: #f5f2f0;
    line-height: 0;
    overflow: hidden;
    margin: 0 -32px;
  }

  .featured__image picture {
    display: block;
    height: auto;
    width: 100%;
  }

  .featured__image img {
    width: 100%;
    object-fit: cover;
    height: auto;
    aspect-ratio: 3 / 1;
  }

  .featured__credit {
    color: #333;
    font-size: 0.825em;
    text-align: right;
    position: absolute;
    right: 0;
    bottom: 0;
    padding: 7px;
    background: #f0f0f0;
    opacity: 0.8;
  }

  .featured__credit a {
    color: #333;
  }

  .lazyload,
  .lazyloading {
    opacity: 0.5;
  }

  .lazyloaded {
    opacity: 1;
    transition: opacity 2s 0.3s cubic-bezier(0.3, 0.18, 0.15, 1);
  }

  .content img {
    max-width: 100%;
  }

  .content img.screenshot {
    display: block;
    height: auto;
    max-width: 100%;
    object-fit: contain;
    border: 4px solid var(--border-color);
    border-radius: var(--border-radius);
  }

  .youtube-wrapper {
    position: relative;
    display: block;
    height: 0;
    padding: 0;
    overflow: hidden;
    padding-bottom: 56.25%;
  }

  .youtube-wrapper iframe {
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    height: 100%;
    width: 100%;
    border: 0;
  }

  .related-posts > div {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(355px, 1fr));
    gap: 20px;
  }

  .related-posts h2 {
    font-size: 1em;
    font-weight: normal;
    margin: 2.5em 0 0.5em 0.5em;
    color: var(--profile-text-color);
  }

  .related-posts article {
    padding: 20px 15px;
    margin-bottom: 0;
  }

  .related-posts article .header:has(.featured__image) {
    margin-bottom: 1em;
  }

  .related-posts .article__title {
    font-size: 1.2em;
  }

  .related-posts .content {
    font-size: 1em;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
    overflow: hidden;
  }

  .related-posts .featured__image {
    margin-left: -15px;
    margin-right: -15px;
  }

  .related-posts .featured__credit {
    display: none;
  }

  .profile {
    border: 1px solid var(--profile-background-color);
    padding: 1em;
    margin-top: 2em;
    color: var(--profile-text-color);
    border-radius: var(--border-radius);
    background: var(--profile-background-color);
  }

  .profile__heading {
    margin-bottom: 0.3em;
    margin-top: 0;
    border-bottom: 1px dashed var(--profile-text-color);
    display: inline-block;
    font-weight: bold;
    font-family: Garamond, "Times New Roman", serif;
  }

  .profile__image {
    float: left;
    margin-right: 6px;
  }

  .profile__content {
    overflow: hidden;
    font-family: sans-serif;
    line-height: 1.5em;
  }

  .navigation__link,
  .profile__content a {
    color: var(--profile-text-color);
  }

  .profile__social-list {
    margin: 0.5em 0 0 0;
    padding: 0;
    list-style-type: none;
  }

  .profile__social-list-item {
    display: inline;
    margin-right: 0.5em;
  }

  .content hr {
    border-top-width: 0;
    border-bottom-width: 1;
    border-style: solid;
    border-color: #ddd;
    margin-top: 4em;
  }

  .pagination {
    display: grid;
    grid-template-columns: repeat(auto-fit, var(--pagination-item-width));
    gap: 10px;
    align-items: center;
    justify-items: center;
    justify-content: center;
    margin: 0;
  }

  .page-number,
  .extend.next,
  .extend.prev,
  .pagination .space {
    width: 100%;
    text-align: center;
    line-height: var(--pagination-item-width);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    background: var(--background-color);
  }

  .pagination .space {
    border-color: transparent;
  }

  .page-number.current {
    background: var(--darker-color);
    font-weight: bold;
    color: white;
    border-color: var(--darker-color);
  }

  .post .writing-vertical {
    writing-mode: vertical-rl;
    font-family: serif;
    font-size: 1em;
    margin: 1.5em 0;
    column-count: 2;
    max-width: var(--container-width);
    width: 102%;
    overflow: auto;
    height: 800px;
  }

  .post .writing-vertical p {
    margin: 0;
  }

  .post .writing-vertical p:first-letter {
    margin-top: 1em;
  }

  .post .writing-vertical .link-icon {
    background-position-x: center;
    background-position-y: 5px;
  }

  .post .writing-vertical blockquote {
    border: none;
    margin: 0 0.5em;
    padding: 1em 0.5em;
    background: #f0f0f0;
  }

  @media screen and (max-width: 500px) {
    .header__epigraph {
      display: none;
    }

    .header__title {
      font-size: 1.2em;
    }

    .content h2 {
      font-size: 1.2em;
    }

    .main .header .header__title {
      margin-bottom: 30px;
    }

    .header__feature {
      margin-top: -23px;
    }

    .featured__credit {
      margin-left: -15px;
      margin-right: -15px;
      position: relative;
    }

    .related-posts .header__feature {
      margin-top: 0.5em;
    }

    .profile-inner {
      display: grid;
      grid-template-areas:
        "icon heading"
        "content content";
      grid-template-columns: 40px auto;
      align-items: center;
    }

    .profile__image {
      grid-area: icon;
      justify-self: center;
    }

    .profile__heading {
      grid-area: heading;
      margin-bottom: 0;
      border-bottom: none;
    }

    .profile__content {
      grid-area: content;
      border-top: 1px dashed var(--profile-text-color);
      margin-top: 0.5em;
      padding-top: 0.5em;
    }
  }

  @media screen and (max-width: 730px) {
    .container {
      padding: 0;
      border-radius: 0;
    }

    article {
      border-radius: 0;
      padding: 1em;
    }

    .article-summary {
      padding: 1em;
    }

    .post .writing-vertical {
      margin-left: 0;
      margin-right: 0;
      width: 100%;
    }

    .header__feature img {
      max-width: 100%;
      height: auto;
    }

    .related-posts .content {
      -webkit-line-clamp: 3;
    }

    .profile {
      border-radius: 0;
      margin-top: 3em;
    }

    .featured__image,
    .content__image,
    .content pre[class*="language-"] {
      margin: 0 -1em;
    }
  }

  @media screen and (max-width: 985px) {
    .container {
      width: 100%;
    }

    .pagination {
      margin: 0 10px;
    }
  }

  pre[class*="language-"] {
    border: 4px solid var(--border-color);
    font-size: 16px;
    border-radius: var(--border-radius);
  }

  /*
 * a11y theme for JavaScript, CSS, and HTML
 * Based on the okaidia theme: https://github.com/PrismJS/prism/blob/gh-pages/themes/prism-okaidia.css
 * @author ericwbailey
 */

  /*
 * MARK: Setup
 */
  @layer vendor-prism {
    @media (forced-colors: none), (forced-colors: active) {
      :root {
        --prism-a11y-border-radius: 0.3em;
        --prism-a11y-font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono",
          monospace;
        --prism-a11y-line-height: 1.5;
        --prism-a11y-code-block-margin: 0.5em 0;
        --prism-a11y-code-block-padding: 1em;
        --prism-a11y-code-inline-padding: 0.1em;
        --prism-a11y-width-border: 1px;
        --prism-a11y-width-tab: 2;
      }
    }

    @media (forced-colors: none), (forced-colors: active) {
      :root {
        --prism-a11y-color-background: hsla(0, 0%, 100%, 1);
        --prism-a11y-color-text-no-token: hsla(0, 0%, 33%, 1);
        --prism-a11y-color-text-comment: hsla(16, 100%, 25%, 1);
        --prism-a11y-color-text-blue: hsla(212, 55.2%, 43.7%, 1);
        --prism-a11y-color-text-cyan: hsla(192, 65.2%, 34.9%, 1);
        --prism-a11y-color-text-green: hsla(120, 100%, 25%, 1);
        --prism-a11y-color-text-gray: hsla(0, 0%, 41%, 1);
        --prism-a11y-color-text-purple: hsla(282, 100%, 41%, 1);
        --prism-a11y-color-text-red: hsla(2, 80%, 47%, 1);
        --prism-a11y-color-text-yellow: hsla(43, 74%, 30%, 1);
        --prism-a11y-plugin-color-border: hsla(43, 74%, 30%, 0.55);
        --prism-a11y-plugin-color-background: hsla(43, 74%, 30%, 0.1);
      }
    }

    @media (forced-colors: none), (forced-colors: active) {
      /*
     * MARK: Theme
     */
      :where(code[class*="language-"], pre[class*="language-"]) {
        color: var(--prism-a11y-color-text-no-token);
        background: var(--prism-a11y-color-background);
        font-family: var(--prism-a11y-font-family);
        text-align: start;
        white-space: pre;
        word-spacing: normal;
        word-break: normal;
        word-wrap: normal;
        line-height: var(--prism-a11y-line-height);

        -moz-tab-size: var(--prism-a11y-width-tab);
        -o-tab-size: var(--prism-a11y-width-tab);
        tab-size: var(--prism-a11y-width-tab);

        -webkit-hyphens: none;
        -moz-hyphens: none;
        -ms-hyphens: none;
        hyphens: none;
      }

      /* Code blocks */
      pre[class*="language-"] {
        padding: var(--prism-a11y-code-block-padding);
        margin: var(--prism-a11y-code-block-margin);
        overflow: auto;
        border-radius: var(--prism-a11y-border-radius);
      }

      :where(:not(pre) > code[class*="language-"], pre[class*="language-"]) {
        background: var(--prism-a11y-color-background);
      }

      /* Inline code */
      :not(pre) > code[class*="language-"] {
        padding: var(--prism-a11y-code-inline-padding);
        border-radius: var(--prism-a11y-border-radius);
        white-space: normal;
      }

      :where(.token.comment, .token.prolog, .token.doctype, .token.cdata) {
        color: var(--prism-a11y-color-text-comment);
      }

      .token.punctuation {
        color: var(--prism-a11y-color-text-gray);
      }

      :where(
          .token.property,
          .token.tag,
          .token.constant,
          .token.symbol,
          .token.deleted
        ) {
        color: var(--prism-a11y-color-text-red);
      }

      :where(
          .token.operator,
          .token.entity,
          .token.url,
          .language-css .token.string,
          .style .token.string,
          .token.variable,
          .token.keyword
        ) {
        color: var(--prism-a11y-color-text-cyan);
      }

      :where(
          .token.selector,
          .token.attr-name,
          .token.string,
          .token.char,
          .token.builtin,
          .token.inserted
        ) {
        color: var(--prism-a11y-color-text-green);
      }

      :where(
          .token.atrule,
          .token.attr-value,
          .token.function,
          .token.regex,
          .token.important
        ) {
        color: var(--prism-a11y-color-text-yellow);
      }

      :where(.token.boolean, .token.number, .token.keyword) {
        color: var(--prism-a11y-color-text-purple);
      }

      :where(.token.important, .token.bold) {
        font-weight: bold;
      }

      .token.italic {
        font-style: italic;
      }

      .token.entity {
        cursor: help;
      }

      /*
     * MARK: Plugin support
     */
      /* Line highlight */
      .line-highlight {
        background: var(--prism-a11y-plugin-color-background);
        border-top: var(--prism-a11y-width-border) solid
          var(--prism-a11y-plugin-color-border);
        border-bottom: var(--prism-a11y-width-border) solid
          var(--prism-a11y-plugin-color-border);
      }

      /* Line numbers */
      .line-numbers .line-numbers-rows {
        border-right: var(--prism-a11y-width-border) solid
          var(--prism-a11y-color-text-no-token);
      }

      .line-numbers-rows > span:before {
        color: var(--prism-a11y-color-text-comment);
      }
    }

    /*
   * MARK: Forced color mode support
   */
    @media (forced-colors: active) {
      :root {
        --prism-a11y-color-background: Canvas;
        --prism-a11y-color-text-no-token: CanvasText;
        --prism-a11y-color-text-comment: GrayText;
        --prism-a11y-color-text-cyan: LinkText;
        --prism-a11y-color-text-gray: LinkText;
        --prism-a11y-color-text-green: CanvasText;
        --prism-a11y-color-text-purple: CanvasText;
        --prism-a11y-color-text-red: CanvasText;
        --prism-a11y-color-text-yellow: GrayText;
        --prism-a11y-plugin-color-border: LinkText;
        --prism-a11y-plugin-color-background: Canvas;
      }

      :where(.token.boolean, .token.number, .token.keyword) {
        font-weight: bold;
      }
    }
  }
</style><link rel="alternate" href="/atom.xml" title="メモログ" type="application/atom+xml"><link rel="alternate" href="https://memolog.org/atom.xml" title="Latest Articles"><link rel="apple-touch-icon" href="/assets/icons/icon-192.png"><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="white"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@graph": [
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "url": "http://memolog.org",
        "logo": "https://memolog.org/assets/icons/icon-1024.png"
      },
      {
        "@context": "http://schema.org",
        "@type": "Person",
        "name": "Yutaka Yamaguchi",
        "url": "http://memolog.org",
        "sameAs": [
          "https://www.facebook.com/yutaka.yamaguchi",
          "https://www.linkedin.com/in/yutakayamaguchi/",
          "https://twitter.com/memolog"
        ]
      }
    ]
  }
</script><meta property="og:type" content="article"><meta property="og:title" content="Collapsed Items"><meta property="og:url" content="https://memolog.org/2025/a-crash-course-on-crises.html"><meta property="og:site_name" content="メモログ"><meta property="og:description" content="今回は4.4. Collapsed Itemsについて<!-- more  -->  > Specifying visibility:collapse on a flex item causes it to become a collapsed flex item, produ"><meta property="og:locale" content="ja_JP"><meta property="og:image" content="/assets/images/nong-vang-w5tI4WACAKo-unsplash/nong-vang-w5tI4WACAKo-unsplash.jpg"><meta property="article:published_time" content="2020-04-12T19:41:53.000Z"><meta property="article:author" content="Yutaka Yamaguchi"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://memolog.org/assets/images/nong-vang-w5tI4WACAKo-unsplash/nong-vang-w5tI4WACAKo-unsplash.jpg"><meta name="twitter:creator" content="@memolog"><meta name="twitter:site" content="https://twitter.com/memolog"><meta property="fb:app_id" content="168245123786587"><link rel="canonical" href="https://memolog.org/2020/flex-collpased-items.html"></head> <body class="post"> <header class="header header_component_global"> <div class="header-inner"> <div class="header__icon" aria-hidden="true"> <img src="/assets/icons/icon.svg" role="presentation" width="32" height="32" alt="icon" loading="lazy"> </div> <h1 class="header__title"> <a href="/">メモログ</a> </h1> <nav class="navigation navigation-global"> <a href="/" class="navigation__link">
📘 最新のメモ
</a> </nav> </div> </header> <div class="container"> <main class="main"> <article> <header class="header"> <div> <time datetime="2020-04-12T19:41:53.000Z"> <span class="calendar-icon">📅</span> <span>2020年4月13日</span> </time> </div> <h2 class="header__title"><span>Collapsed Items</span></h2> <div class="header__feature" aria-hidden="true"> <div class="featured__image" style="background-color: #968e7b;"> <div style="background-color: #968e7b"> <img src="/assets/images/nong-vang-w5tI4WACAKo-unsplash/nong-vang-w5tI4WACAKo-unsplash.svg" alt role="presentation" loading="eager" width="985" height="654"> </div> </div> <div class="featured__credit">Original photo by <a href="https://unsplash.com/@californong?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener" tabindex="-1">Nong Vang</a> on <a href="https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener" tabindex="-1">Unsplash</a>, edited with <a href="https://github.com/fogleman/primitive" target="_blank" rel="noopener" tabindex="-1">Primitive</a></div> </div> </header> <div id="article-content" class="content">  <p>今回は<a href="https://www.w3.org/TR/css-flexbox-1/#visibility-collapse">4.4. Collapsed Items</a>について<!-- more  --></p>
<blockquote>
<p>Specifying visibility:collapse on a flex item causes it to become a collapsed flex item, producing an effect similar to visibility:collapse on a table-row or table-column: the collapsed flex item is removed from rendering entirely, but leaves behind a “strut” that keeps the flex line’s cross-size stable. Thus, if a flex container has only one flex line, dynamically collapsing or uncollapsing items may change the flex container’s main size, but is guaranteed to have no effect on its cross size and won’t cause the rest of the page’s layout to “wobble”. Flex line wrapping is re-done after collapsing, however, so the cross-size of a flex container with multiple lines might or might not change.</p>
<p>Though collapsed flex items aren’t rendered, they do appear in the formatting structure. Therefore, unlike on display:none items [CSS21], effects that depend on a box appearing in the formatting structure (like incrementing counters or running animations and transitions) still operate on collapsed items.</p>
</blockquote>
<p>flex itemに<code>visibility:collapse</code>を指定するとflex itemが折り畳まれるようになり、table-rowやtable-columnにおけるvisibility:collapseと同様の効果を得ることができる。折り畳まれたflex itemはレンダリングから完全に削除されるが、flex lineのcross-sizeを安定させるための「支柱」を残す。そのため、もしflex containerにflex lineが一つしかない場合、itemsを折り畳んだり開いたりすることはflex containerのmain sizeを変更するかもしれないが、cross sizeには効果を及ぼさないことが保証され、ページの残りのレイアウトが「揺らぐ」ことはない。しかしながら、Flex lineの折り返しは折り畳まれた後に再度折り返しが実行されるので、複数行にまたがるflex containerのcross-sizeは変わるかもしれないし、変わらないかもしれない。</p>
<p>折り畳まれたflex itemsはレンダリングされないけれども、それらはformatting structureには出現する。したがって、display:noneとは異なり、（incrementing counterやアニメーションやtransitionなどの実行のように）formatting structureに現れるboxに依存する効果は、折り畳まれたitemに対しても実行が続く。</p>
<blockquote>
<p><strong>EXAMPLE 4</strong> In the following example, a sidebar is sized to fit its content. visibility: collapse is used to dynamically hide parts of a navigation sidebar without affecting its width, even though the widest item (“Architecture”) is in a collapsed section.</p>
</blockquote>
<p>次の例では、サイドバーはコンテンツに合わせてサイズが調整される。<code>visibility: collapse</code>はサイドバーの一部分を動的に見えなくする。たとえ最も幅が広いアイテム（ここでは「Architecture」の項目）が折り畳まれたセクションにある場合でも、横幅に影響が出ないようになっている。</p>
<img src="/assets/images/screencapture_collapsed_itmes.gif" width="803" style="border:5px solid #f0f0f0">
<pre class="language-css" data-language="css"><code is:raw="" class="language-css"><span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 60em<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* 十分な空間があるときだけ2カラムのレイアウトになる
  （文字サイズはデフォルトのサイズから相対的に決まる） */</span>
  <span class="token selector">div</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">#main</span> <span class="token punctuation">{</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span> <span class="token comment">/* メイン部分は残った空間全てを使う */</span>
    <span class="token property">order</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span> <span class="token comment">/* （右の）ナビゲーションの後に配置する */</span>
    <span class="token property">min-width</span><span class="token punctuation">:</span> 12em<span class="token punctuation">;</span> <span class="token comment">/* メインコンテンツのサイズを最適化する */</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/* メニューのアイテムはvisibility:collapseが動くように
flex layoutを利用する。 */</span>
<span class="token selector">nav > ul > li</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-flow</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* サブメニューはターゲットでないときに折り畳まれる */</span>
<span class="token selector">nav > ul > li:not(:target):not(:hover) > ul</span> <span class="token punctuation">{</span>
  <span class="token property">visibility</span><span class="token punctuation">:</span> collapse<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-html" data-language="html"><code is:raw="" class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>article</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>main<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Interesting Stuff to Read<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>article</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>nav</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ul</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-about<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#nav-about<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>About<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span> …<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-projects<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#nav-projects<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Projects<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ul</span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Art<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Architecture<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Music<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ul</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-interact<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#nav-interact<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Interact<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span> …<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ul</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>nav</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>footer</span><span class="token punctuation">></span></span>…<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>footer</span><span class="token punctuation">></span></span>
</code></pre>
<p><code>flex</code>ショートハンドは、以下のような定義になっている。</p>
<blockquote>
<p>none | [ &#x3C;‘flex-grow’> &#x3C;‘flex-shrink’>? || &#x3C;‘flex-basis’> ]`</p>
</blockquote>
<p><code>flex: 1</code>の場合、<code>flex: 1 1 0</code> と記述されるのと同じになる。未設定の初期値は <code>flex: 0 1 auto</code>となるのだが、<a href="https://www.w3.org/TR/css-flexbox-1/#flex-initial">7.1.1. Basic Values of flex</a>に以下のような説明がついている。</p>
<blockquote>
<p><strong>flex: initial</strong>
Equivalent to flex: 0 1 auto. (This is the initial value.) Sizes the item based on the width/height properties. (If the item’s main size property computes to auto, this will size the flex item based on its contents.) Makes the flex item inflexible when there is positive free space, but allows it to shrink to its minimum size when there is insufficient space. The alignment abilities or auto margins can be used to align flex items along the main axis.</p>
</blockquote>
<p>flex itemはwidth/heightのプロパティに基づいてサイズ調整される（もしitemのmain sizeプロパティがautoと計算された場合、そのコンテンツを基にサイズが調整される）。空いてるスペースがある場合、flex itemは不変（inflexible）であるけど、十分なスペースがない場合は最小サイズまで縮小することができる。alignmentやauto marginsはmain axisに沿ってflex itemsを揃えるために使われる。</p>
<p>つまり、上の例のCSSの場合、<code>nav</code>の部分の横幅は（十分な空間があれば）コンテンツの長さと同じになる。その時のコンテンツの長さは<code>visibility: collapse</code>による影響を受けない。<code>#main</code>の部分は空いてる空間に応じて広がる。</p>
<p><code>order</code>の初期値は0なので（<a href="https://www.w3.org/TR/css-flexbox-1/#order-property">5.4. Display Order: the order property</a>）、<code>order: 1</code>を設定することで、<code>&#x3C;nav></code>の方が先に配置される。</p>
<blockquote>
<p>To compute the size of the strut, flex layout is first performed with all items uncollapsed, and then re-run with each collapsed item replaced by a strut that maintains the original cross-size of the item’s original line. See the <a href="https://www.w3.org/TR/css-flexbox-1/#layout-algorithm">Flex Layout Algorithm</a> for the normative definition of how visibility:collapse interacts with flex layout.</p>
</blockquote>
<p>「支柱(strut)」のサイズを計算するために、flexレイアウトは最初にすべてのitemを折り畳まれていない状態（uncollapsed）で実行され、その後に、折り畳まれるitemをitemのオリジナルの行のオリジナルのcross-sizeを維持する支柱によって置き換えて再実行する。</p>
<blockquote>
<p><strong>Note</strong>: Using visibility:collapse on any flex items will cause the flex layout algorithm to repeat partway through, re-running the most expensive steps. It’s recommended that authors continue to use display:none to hide items if the items will not be dynamically collapsed and uncollapsed, as that is more efficient for the layout engine. (Since only part of the steps need to be repeated when visibility is changed, however, ‘visibility: collapse’ is still recommended for dynamic cases.)</p>
</blockquote>
<p>flex itemにvisibility:collapseを使うことは、flexレイアウトのアルゴリズムを途中で繰り返すことになり、最も高コストなステップを再実行することになる。もしitemを動的に折り畳んだり展開したりしないなら、アイテムを非表示にするのには display:none を使うことを推奨する。レイアウトエンジンにとってその方が効率的だから。（しかしながら、visibilityが変わったらステップの一部は繰り返す必要があるので、動的に変更するケースにおいては <code>visibility: collapse</code> は推奨される）。</p>  </div> <footer class="profile"> <div class="profile-inner"> <div class="profile__image"> <img src="/assets/icons/icon.svg" role="presentation" width="48" height="48" alt=""> </div> <h2 class="profile__heading">私について</h2> <div class="profile__content"> <div>Yutaka Yamaguchi</div> <div>
東京在住。TypeScript, Node.js,
        Reactなどフロンエンドが主力。Perlも書く。SwiftやRubyも過去には使ってた。過去のTOEIC
        860くらい。
</div> <ul class="profile__social-list"> <li class="profile__social-list-item"> <a href="https://twitter.com/memolog">X</a> </li> <li class="profile__social-list-item"> <a href="https://www.linkedin.com/in/yutakayamaguchi/">LinkedIn</a> </li> </ul> </div> </div> </footer> </article> </main> <aside class="related-posts"> <h2 class="header__title">📖 関連メモ</h2> <div> <article class="article-summary"> <header class="header"> <div> <time datetime="2020-04-04T19:27:59.000Z"> <span class="calendar-icon">📅</span> <span>2020年4月5日</span> </time> </div> <h3 class="header__title article__title"> <a href="/2020/flex-item-margin-padding-and-z-ordering.html">Flex Item Margin, Padding and Z-Ordering</a> </h3> <div class="header__feature" aria-hidden="true"> <div class="featured__image" style="background-color: #b9c5d1;"> <img src="/assets/images/marc-klemm-nw0QE7nTqOc-unsplash/marc-klemm-nw0QE7nTqOc-unsplash_medium.webp" srcset="/assets/images/marc-klemm-nw0QE7nTqOc-unsplash/marc-klemm-nw0QE7nTqOc-unsplash_medium.webp, /assets/images/marc-klemm-nw0QE7nTqOc-unsplash/marc-klemm-nw0QE7nTqOc-unsplash_medium@2x.webp 2x" role="presentation" loading="lazy" width="985" height="328" alt> </div> <div class="featured__credit">Photo by <a href="https://unsplash.com/@marcklemm?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener" tabindex="-1">Marc Klemm</a> on <a href="https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener" tabindex="-1">Unsplash</a></div> </div> </header> <div class="content">今回は4.2. Flex Item Margins and Paddingsと4.3. Flex Item Z-Orderingについて</div> <div class="read-more"> <a href="/2020/flex-item-margin-padding-and-z-ordering.html">📖 続きを読む</a> </div> </article><article class="article-summary"> <header class="header"> <div> <time datetime="2020-03-10T22:12:24.000Z"> <span class="calendar-icon">📅</span> <span>2020年3月11日</span> </time> </div> <h3 class="header__title article__title"> <a href="/2020/automatic-box-type-transformations.html">Automatic Box Type Transformations</a> </h3> <div class="header__feature" aria-hidden="true"> <div class="featured__image" style="background-color: #948e88;"> <div style="background-color: #948e88"> <img src="/assets/images/jeremy-bishop-t52E8yzCURM-unsplash/jeremy-bishop-t52E8yzCURM-unsplash.svg" alt role="presentation" loading="lazy" width="985" height="550"> </div> </div> <div class="featured__credit">Original photo by <a href="https://unsplash.com/@jeremybishop?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener" tabindex="-1">Jeremy Bishop</a> on <a href="https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener" tabindex="-1">Unsplash</a>, edited with <a href="https://github.com/fogleman/primitive" target="_blank" rel="noopener" tabindex="-1">Primitive</a></div> </div> </header> <div class="content">Box Layout Modes: the display propertyの最後の節として 2.7. Automatic Box Type Transformationsについて書かれているので、簡単に確認する。何らかのレイアウト効果の影響でboxのタイプが自動的に変わる場合があるという話。</div> <div class="read-more"> <a href="/2020/automatic-box-type-transformations.html">📖 続きを読む</a> </div> </article><article class="article-summary"> <header class="header"> <div> <time datetime="2020-05-30T23:45:00.000Z"> <span class="calendar-icon">📅</span> <span>2020年5月31日</span> </time> </div> <h3 class="header__title article__title"> <a href="/2020/flex-lines.html">Flex Lines</a> </h3> <div class="header__feature" aria-hidden="true"> <div class="featured__image" style="background-color: #e2dfd7;"> <img src="/assets/images/flex-lines/flex-lines_medium.webp" srcset="/assets/images/flex-lines/flex-lines_medium.webp, /assets/images/flex-lines/flex-lines_medium@2x.webp 2x" role="presentation" loading="lazy" width="985" height="328" alt> </div> <div class="featured__credit">Image by <a href="https://chatgpt.com/" target="_blank" rel="noopener" tabindex="-1">ChatGPT</a></div> </div> </header> <div class="content">今回は6. Flex Linesについて。</div> <div class="read-more"> <a href="/2020/flex-lines.html">📖 続きを読む</a> </div> </article><article class="article-summary"> <header class="header"> <div> <time datetime="2016-01-11T22:15:00.000Z"> <span class="calendar-icon">📅</span> <span>2016年1月12日</span> </time> </div> <h3 class="header__title article__title"> <a href="/2016/01/view_controller_lifecycle.html">View Controller Lifecycle</a> </h3>  </header> <div class="content">viewDidLoadとviewDidAppearの使い方についてのメモ（ほぼ公式ドキュメントのコピペ）。引用中の太字装飾は私。  Work with View Controllersにある「Understand the View Controller Lifecycle」に書いてある説明は以下のような感じ。</div> <div class="read-more"> <a href="/2016/01/view_controller_lifecycle.html">📖 続きを読む</a> </div> </article> </div> </aside> </div> </body></html>